#!/usr/bin/perl
use strict;
use warnings;

# lung from 6025777 (1:500) to 6025778 (501:1000)
# Pan from 6030291 (1:500) to 6030292 (501:1000)

my @never_cell = qw(R_13 R_14 R_27 N12YC2 N12YD2 N12YF2 N1407_4 N1407_7 N1407_2 N1407_3 N1295_3 N1295_5 N1295_1 N1295_7 N1295_8 N1410_1 N1410_3 N1410_4 N1410_6 A1306_5 N1305_3 S1306_9 N1305_6 N1305_7 N1401_1 N1401_2 N1401_3 C3_1 C3_4 C3-7 C3_5 C2-5 C2-8 C2-9 C2_2 C2_10 C2_12 S1304_6 A1304_2 A1304_5 N1415_11 N1415_3 N1415_9 C1-1 C1-3 C1-4 N1281_3 N1281_6 N1281_7 A1354_18 S1423_2 S1423_3 S1423_4);
my @smoke_cell = qw(B2-2 B2-3 B2-4 B2_5 S1236_4 S1320_1 S1320_4 S1236_3 S1236_5 S1320_2 B3-1 B3-3 B3-4 A1277_7 A1306_6 N1306_14 N1306_15 A1383_5 A1383_6 S1383_8 A1354_13 E1_13 S1282_2 S1282_5 S1282_3 A1354a11 A1354a6 E1_10 S1282_6 S1282_7 A1354a3 A1354_2 B1_1 B1_4 B1-6 B1_5 A1319a1 A1319a4 A1319a6 A1302a1 A1302a4 Aa1302a5 S1285_5 Aa1285_1 Aa1285_4 A1394_1 A1394_10 A1394_6 A1394_9 A1394_2 A1394_7 S1235_1 A1235_5 A1235_6 S1409_3 S1409_7 S1409_6 E1-2 E1-3 E1_1 A1354_14 S1423_2_E1 E1_4 E1_6 E1_9 F2-3 F2-5 F2_10 F2_8 S1303_7 S1303_8 S1303_6 S1303_1 S1303_9 S1263_1 S1263_4 S1263_3 G4-3 G4-7 G4_8 G4_11);
my @cancer_cell = qw(S1304_6 A1304_2 A1304_5 S1236_4 S1320_1 S1320_4 S1236_3 S1236_5 S1320_2 A1277_7 A1306_6 N1306_14 N1306_15 A1383_5 A1383_6 S1383_8 A1354_13 E1_13 S1282_2 S1282_5 S1282_3 A1354a11 A1354a6 E1_10 S1282_6 S1282_7 A1354a3 A1354_2 A1319a1 A1319a4 A1319a6 A1302a1 A1302a4 Aa1302a5 S1285_5 Aa1285_1 Aa1285_4 E1-2 E1-3 E1_1 A1354_14 S1423_2_E1 E1_4 E1_6 E1_9 F2-3 F2-5 F2_10 F2_8 S1303_7 S1303_8 S1303_6 S1303_1 S1303_9 S1263_1 S1263_4 S1263_3 G4-3 G4-7 G4_8 G4_11);

my %hash_never;
my %hash_smoke;
my %hash_cancer;
my %hash_sen;

for (my $i = 0; $i < @never_cell; $i++) {
	$hash_never{$never_cell[$i]} = 1;
}
for (my $i = 0; $i < @smoke_cell; $i++) {
	$hash_smoke{$smoke_cell[$i]} = 1;
}
for (my $i = 0; $i < @cancer_cell; $i++) {
	$hash_cancer{$cancer_cell[$i]} = 1;
}
{
	my @cell = qw(R_13 R_14 R_27 N12YC2 N12YD2 N12YF2 N1407_4 N1407_7 N1407_2 N1407_3 N1295_3 N1295_5 N1295_1 N1295_7 N1295_8 N1410_1 N1410_3 N1410_4 N1410_6 A1306_5 N1305_3 S1306_9 N1305_6 N1305_7 N1401_1 N1401_2 N1401_3 C3_1 C3_4 C3-7 C3_5 C2-5 C2-8 C2-9 C2_2 C2_10 C2_12 S1304_6 A1304_2 A1304_5 N1415_11 N1415_3 N1415_9 C1-1 C1-3 C1-4 N1281_3 N1281_6 N1281_7 A1354_18 S1423_2 S1423_3 S1423_4 B2-2 B2-3 B2-4 B2_5 S1236_4 S1320_1 S1320_4 S1236_3 S1236_5 S1320_2 B3-1 B3-3 B3-4 A1277_7 A1306_6 N1306_14 N1306_15 A1383_5 A1383_6 S1383_8 A1354_13 E1_13 S1282_2 S1282_5 S1282_3 A1354a11 A1354a6 E1_10 S1282_6 S1282_7 A1354a3 A1354_2 B1_1 B1_4 B1-6 B1_5 A1319a1 A1319a4 A1319a6 A1302a1 A1302a4 Aa1302a5 S1285_5 Aa1285_1 Aa1285_4 A1394_1 A1394_10 A1394_6 A1394_9 A1394_2 A1394_7 S1235_1 A1235_5 A1235_6 S1409_3 S1409_7 S1409_6 E1-2 E1-3 E1_1 A1354_14 S1423_2_E1 E1_4 E1_6 E1_9 F2-3 F2-5 F2_10 F2_8 S1303_7 S1303_8 S1303_6 S1303_1 S1303_9 S1263_1 S1263_4 S1263_3 G4-3 G4-7 G4_8 G4_11);
	my @sen = qw(0.721 0.723 0.757 0.757 0.704 0.665 0.769 0.766 0.156 0.725 0.449 0.344 0.554 0.649 0.464 0.421 0.835 0.782 0.560 0.555 0.836 0.668 0.799 0.670 0.686 0.676 0.714 0.737 0.499 0.698 0.595 0.805 0.881 0.738 0.357 0.667 0.759 0.653 0.746 0.649 0.773 0.406 0.791 0.645 0.782 0.812 0.728 0.700 0.596 0.733 0.741 0.672 0.715 0.633 0.810 0.689 0.833 0.759 0.769 0.577 0.772 0.671 0.705 0.661 0.756 0.860 0.673 0.505 0.695 0.818 0.698 0.595 0.515 0.758 0.842 0.665 0.719 0.670 0.575 0.725 0.659 0.544 0.329 0.806 0.730 0.628 0.736 0.768 0.786 0.712 0.690 0.773 0.643 0.580 0.736 0.774 0.786 0.872 0.557 0.593 0.724 0.605 0.619 0.721 0.595 0.691 0.785 0.600 0.740 0.548 0.307 0.818 0.658 0.662 0.512 0.638 0.724 0.779 0.631 0.692 0.736 0.562 0.742 0.841 0.799 0.685 0.651 0.810 0.833 0.831 0.640 0.830 0.818 0.695);
	for (my $i = 0; $i < @cell; $i++) {
		$hash_sen{$cell[$i]} = $sen[$i];
	}
}

for (my $j = 6030291; $j <= 6030292; $j++) {
	for (my $k = 1; $k <= 500; $k++) {
		my $i = $k;
		$i = $k + 500 if ($j == 6030292);
		next unless (-e "/gs/gsfs0/users/zhehuang/projects/Smoke_result_compile/Driver/result/gene_set.o$j\.$i");
		my @cov = qw(0 0 0);
		my @sum = qw(0 0 0);
		open(F, "/gs/gsfs0/users/zhehuang/projects/Smoke_result_compile/Driver/result/gene_set.o$j\.$i");
		<F>;
		while (my $content = <F>) {
			chomp $content;
			my @data = split(/ /, $content);
			if (exists $hash_never{$data[0]}) {
				$cov[0]+= $data[2];
				$sum[0]+= $data[3]/$hash_sen{$data[0]};
			}
			if (exists $hash_smoke{$data[0]}) {
				$cov[1]+= $data[2];
				$sum[1]+= $data[3]/$hash_sen{$data[0]};
			}
			if (exists $hash_cancer{$data[0]}) {
				$cov[2]+= $data[2];
				$sum[2]+= $data[3]/$hash_sen{$data[0]};
			}
		}
		close(F);
		print STDERR "$cov[0]\t$sum[0]\t$cov[1]\t$sum[1]\t$cov[2]\t$sum[2]\n";
	}
}


